(()=>{var G=[1,"1244.00","1480.00"];var S=star_zxq,b=star_a1c,v=star_p89;ke();var w=[];ye();var Q=[1,"HarvestHome"],U=[1,"HarvestOutpost"],V=[1,"PokeEnemyBase"],W=[1,"AttackEnemyStar"],X=[0,"AttackEnemyBase"],Y=[0,"AttackEnemyBase"],Z=[0,"HarvestHome"],$=[0,"AttackEnemyBase"],L=[0,"AttackEnemyBase"],fe="PokeEnemyBase",q=90,P=0,E=[0,0,0,0,0,0,0,0,0,0],ee=[Q[0],U[0],V[0],W[0],X[0],Y[0],Z[0],$[0],L[0],999],k=[Q[1],U[1],V[1],W[1],X[1],Y[1],Z[1],$[1],L[1],fe],ae=new Date,a=my_spirits[0].energy_capacity;je();ze();_e();Se();ue();pe();de();ve();he();Ae();Re();De();be();ce();ge();function ge(){for(spirit of my_spirits)spirit.hp!=0&&spirit.shout(memory[spirit.id]);console.log("Position: "+G),console.log("Squad9: "+E[9]),console.log("Total: "+Ee().length),console.log("Tick: "+tick),console.log("total execution time: "+(Date.now()-ae)+"ms"),console.log("Enemy shape: "+enemy_base.shape)}function ye(){memory["rally position"+G[0]]=[G[1],G[2]];for(let e=0;e<10;e++)w[e]=memory["rally position"+e],w[e]!=null&&(graphics.style="white",graphics.circle(w[e],1),graphics.circle(w[e],5),Ge([w[e][0],parseFloat(w[e][1])+30],e,"grey",.8))}function ue(){var e=-1;for(s of z("DefendBase")){e+=1;let n=m(base.position,S.position,-125),l,r=100;base.position[0]<outpost.position[0]?l=[1590,900]:l=[2650,1570];let t=T(n,l,e,z("DefendBase").length);for(;y(t,base.position)<r;)t=m(t,base.position,-1);for(;y(t,base.position)>r;)t=m(t,base.position,1);let f=m(S.position,base.position,190),g=p(s,200),u=J(t,base.sight.enemies);if(a==10&&(t=[1600,750],u!=null&&(t=m(base.position,u.position,60))),["Attacking","Searching","Recovering"].includes(memory[s.id])||(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&(R(s)&&(h(p(base,400))>base.energy&&s.energy>=a*.4&&(memory[s.id]="Searching"),s.energy>a*.9&&(memory[s.id]="Searching")),a==10&&(memory[s.id]="Searching")),memory[s.id]=="Searching"&&(u!=null&&u.energy<s.energy&&(memory[s.id]="Attacking"),g.length>0&&(memory[s.id]="Attacking"),(!R(s)||u==null&&s.energy<a*.9)&&(memory[s.id]="Recovering"),a==10&&s.energy>1&&(memory[s.id]="Attacking")),memory[s.id]=="Attacking"&&(!R(s)&&a!=10&&(memory[s.id]="Recovering"),u==null&&(memory[s.id]="Searching")),memory[s.id]=="Recovering"&&(te(s)?d(s,t):(d(s,f),s.energize(s)),R(s)&&A(s),B(s),H(s)),memory[s.id]=="Searching"&&(d(s,t),A(s),H(s)),memory[s.id]=="Attacking"){var i=A(s),o;if(i!=null?(o=m(i.position,t,180),a==10&&(o=m(i.position,t,199))):u!=null&&(o=m(u.position,base.position,180),a==10&&(o=m(u.position,base.position,199))),outpost.energy>500&&outpost.control!="Aecert")for(;y(o,outpost.position)<=600;)o=m(outpost.position,o,y(o,outpost.position)+3);s.move(o),i==null&&a!=10&&_(s),H(s)}}}function pe(){var e=-1;for(s of z("DefendOutpost")){e+=1;let n,l,r=125;base.position[0]<outpost.position[0]?(n=[2190,1270],l=[1900,1600]):(n=[2020,1130],l=[1750,1500]);let t=T(n,l,e,z("DefendOutpost").length);for(;y(t,v.position)<r;)t=m(t,v.position,-1);for(;y(t,v.position)>r;)t=m(t,v.position,1);let f=300,g;base.position[0]<outpost.position[0]?g=[2020,1130]:g=[2190,1270],(outpost.control!="Aecert"||z("DefendOutpost").length==1||v.energy==0)&&(t=g,f=200);let u=p(s,200),c=J(t,outpost.sight.enemies);if(c!=null&&y(c.position,outpost.position)>f&&(c=null),outpost.control!="Aecert"&&outpost.energy!=0&&(c=null),["Attacking","Searching","Recovering"].includes(memory[s.id])||(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&R(s)&&(memory[s.id]="Searching"),memory[s.id]=="Searching"&&(c!=null&&c.energy<s.energy&&(memory[s.id]="Attacking"),u.length>0&&(memory[s.id]="Attacking"),(!R(s)||c==null&&s.energy<a*.9&&u.length==0)&&(memory[s.id]="Recovering")),memory[s.id]=="Attacking"&&(R(s)||(memory[s.id]="Recovering"),c==null&&u.length==0&&(memory[s.id]="Searching")),memory[s.id]=="Recovering"&&(te(s)?(s.move(t),C(s)):(s.move(g),s.energize(s)),(outpost.energy==0&&Ce(p(s,200))+a*.1<s.energy||outpost.control!="Aecert"&&c==null&&s.energy>a*.5)&&s.energize(outpost),memory[s.id+"jumped"]==!0&&(A(s),memory[s.id+"jumped"]=!1),B(s),H(s)),memory[s.id]=="Searching"&&(s.move(t),s.energize(s),A(s),H(s),outpost.control!="Aecert"?s.energy>a*.2&&s.energize(outpost):outpost.energy<990&&(v.energy>250&&e==0&&s.energize(outpost),v.energy>700&&e==2&&s.energize(outpost)),a<100&&s.energize(outpost)),memory[s.id]=="Attacking"){s.energize(s);var i=A(s),o=n;i!=null?o=m(i.position,v.position,199):c!=null&&(o=m(c.position,v.position,199)),s.move(o),i==null&&_(s),outpost.energy==0&&y(s.position,outpost.position)<200&&s.energize(outpost),B(spirit),H(s)}}}function de(){var e=-1;for(s of z("DefendHomeStar")){e+=1;let n,l,r=150;base.position[0]<outpost.position[0]?(n=[1200,1100],l=[900,1250]):(n=[3020,1330],l=[3300,1250]);let t=T(n,l,e,z("DefendHomeStar").length);for(;y(t,S.position)<r;)t=m(t,S.position,-1);for(;y(t,S.position)>r;)t=m(t,S.position,1);let f=m(S.position,s.position,150),g=p(s,400),u=400,c=J(t,s.sight.enemies);if(c!=null&&y(c.position,S.position)>u&&(c=null),["Attacking","Searching","Recovering"].includes(memory[s.id])||(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&R(s)&&(memory[s.id]="Searching"),memory[s.id]=="Searching"&&(c!=null&&c.energy<s.energy&&(memory[s.id]="Attacking"),g.length>0&&(memory[s.id]="Attacking"),(!R(s)&&s.energ||c==null&&s.energy<a*.9)&&(memory[s.id]="Recovering")),memory[s.id]=="Attacking"&&(!R(s)&&s.energy<=a*.5&&(memory[s.id]="Recovering"),c==null&&(memory[s.id]="Searching")),memory[s.id]=="Recovering"&&(d(s,f),s.energize(s),memory[s.id+"jumped"]==!0&&A(s),B(s),H(s)),memory[s.id]=="Searching"){d(s,t),s.energize(s);var i=A(s);i==null&&_(s),H(s)}if(memory[s.id]=="Attacking"){s.energize(s);var i=A(s),o=t;i!=null?o=m(i.position,S.position,199):c!=null&&(o=m(c.position,S.position,199)),s.move(o),i==null&&_(s),B(spirit),H(s)}}}function ce(){for(let i=0;i<10;i++)if(k[i].includes("RallyPoint")){let o=x(i),n=k[i][k[i].length-1],l=k[i].includes("Aggro"),r;r=w[n];for(spirit of o){memory[spirit.id]="Rallying",r!=null&&d(spirit,r);let t=O(spirit,spirit.sight.enemies);if(l){let f=A(spirit);f!=null?d(spirit,m(f.position,spirit.position,198)):y(spirit.position,r)<200&&t!=null&&d(spirit,m(t.position,spirit.position,198)),f==null&&(f=C(spirit)),f==null&&spirit.energize(spirit)}if(!l){var e;h(p(spirit,250))<=spirit.energy?(e=A(spirit),e!=null&&d(spirit,m(e.position,spirit.position,198))):d(spirit,m(t.position,spirit.position,275)),e==null&&(e=C(spirit)),e==null&&spirit.energize(spirit)}}}}function ve(){for(s of z("AttackEnemyBase")){if(y(s.position,enemy_base.position)>=200){d(s,enemy_base.position),memory[s.id]="Traveling";let r=[],t=0;for(jumpSpirit of z("AttackEnemyBase")){let f=m(enemy_base.position,jumpSpirit.position,199),g=y(jumpSpirit.position,f),u=g/5;jumpSpirit.energy-u>=40&&g<=300&&a==100&&(t+=u,r.push(jumpSpirit))}if(h(j(enemy_base,300))*2+t+enemy_base.energy+50<h(r)&&a==100&&enemy_base.shape!="triangles")for(jumper of r)jumper.jump(m(enemy_base.position,jumper.position,199))}var e,i;y(s.position,enemy_base.position)<=200?memory[s.id]="Ending Game":e=A(s),e!=null?(memory[s.id]="Attacking",s.move(m(e.position,s.position,190))):memory[s.id]!="Ending Game"&&(i=_(s)),i!=null&&(s.move(m(i.position,s.position,10)),memory[s.id]="Healing")}var o=0;let n=qe(enemy_base);for(bh of n)o+=bh.size;var l=0;for(s of we("Ending Game"))a*.2+enemy_base.energy+o>l*a*.2&&s.energy>0?(s.energize(enemy_base),l+=1):A(s)!=null?memory[s.id]="Attacking":_(s)!=null&&(memory[s.id]="Healing")}function he(){for(s of z("AttackEnemyStar")){var e=m(b.position,enemy_base.position,190);if(d(s,e),memory[s.id]="Traveling",(R(s)&&s.energy>=a*.2||s.energy>=a*.8)&&A(s)!=null&&(memory[s.id]="Attacking"),memory[s.id]!="Attacking"&&C(s)!=null&&(memory[s.id]="Healing"),memory[s.id]=="Traveling"){s.energize(s),memory[s.id]="Recovering";var i=m(b.position,s.position,195);y(s.position,b.position)>200&&!R(s)&&s.jump(i)}}}function Ae(){let e=0;for(s of z("PokeEnemyBase")){e++;var i=m(S.position,s.position,199);(outpost.control=="Aecert"||outpost.energy==0&&v.energy>0)&&(i=m(v.position,s.position,199),y(s.position,b.position)<y(s.position,v.position)&&(i=m(b.position,s.position,199)));var o=m(enemy_base.position,b.position,-399);if((outpost.control=="Aecert"||outpost.energy==0)&&(o=m(enemy_base.position,v.position,350),outpost.energy>=500&&(o=m(outpost.position,enemy_base.position,399))),(e==2||e==6||e==10||e==14)&&v.energy>0&&(o=m(v.position,o,199)),["Attacking","Recovering"].includes(memory[s.id])||(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&s.energy>=a*.9&&(memory[s.id]="Attacking"),memory[s.id]=="Attacking"&&(s.energy<=a*.2&&(memory[s.id]="Recovering"),R(s)||(memory[s.id]="Recovering"),j(enemy_base,400).length==0&&s.energy>0&&(memory[s.id]="Attacking")),memory[s.id]=="Recovering"&&(N(s,i),s.energize(s),R(s)||s.jump(m(s.position,i,50)),p(s,210).length==0&&C(s)),memory[s.id]=="Attacking"){d(s,o);var n=A(s);n!=null&&s.move(m(n.position,s.position,199)),n==null&&(n=_(s)),n==null&&s.energize(s),h(j(enemy_base,200))<s.energy&&s.move(m(enemy_base.position,s.position,199)),p(s,200).length==0&&y(enemy_base.position,s.position)<200&&s.energize(enemy_base),h(p(s,215))>h(j(s,50))+s.energy&&s.move(i)}}}function Re(){for(s of z("PokeEnemyStar")){var e=m(b.position,enemy_base.position,-199),i=e;s.sight.enemies.length>0&&(i=m(O(s,s.sight.enemies).position,s.position,250));var o=m(b.position,enemy_base.position,199);if(["Attacking","Fleeing","Recovering"].includes(memory[s.id])||(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&(s.energy>a*.9&&(memory[s.id]="Attacking"),h(p(s,240))>s.energy&&(memory[s.id]="Fleeing")),memory[s.id]=="Fleeing"&&h(p(s,240))<=s.energy&&(s.energy<=a*.9&&(memory[s.id]="Recovering"),h(p(s,200))<=s.energy&&(memory[s.id]="Attacking")),memory[s.id]=="Attacking"&&(s.energy<=a*.2&&(memory[s.id]="Recovering"),h(p(s,230))>s.energy&&(memory[s.id]="Fleeing")),memory[s.id]=="Recovering"&&(N(s,e),s.energize(s),R(s)||s.jump(m(s.position,i,40)),h(p(s,200))<s.energy&&A(s)),memory[s.id]=="Fleeing"&&(N(s,i),s.energize(s),R(s)||s.jump(i),h(p(s,200))<s.energy&&A(s)),memory[s.id]=="Attacking"){d(s,o);var n=A(s);n!=null&&s.move(m(n.position,s.position,199)),n==null&&(n=_(s)),n==null&&s.energize(s)}}}function De(){for(s of z("RushEnemyStar")){var e=m(b.position,s.position,199),i=m(b.position,enemy_base.position,-199),o=m(b.position,enemy_base.position,199);if(["Attacking","Rushing","Recovering"].includes(memory[s.id])||(memory[s.id]="Rushing"),memory[s.id]=="Rushing"&&y(s.position,b.position)<200&&(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&(s.energy>a*.5&&(memory[s.id]="Attacking"),s.energy-10>=h(p(s,220))*1.5&&(memory[s.id]="Attacking"),b.energy<5&&(memory[s.id]="Attacking")),memory[s.id]=="Attacking"&&(s.energy<=a*.2&&p(s,400).length>0&&(memory[s.id]="Recovering"),s.energy<h(p(s,220))&&!R(s)&&(memory[s.id]="Recovering"),b.energy<5&&(memory[s.id]="Attacking")),memory[s.id]=="Rushing"&&(s.move(e),graphics.circle(e,2),A(s),h(p(s,210))*2>s.energy&&10+y(s.position,e)/5<s.energy&&(s.jump(e),s.energize(s)),R(s)||(s.jump(e),s.energize(s))),memory[s.id]=="Recovering"&&(s.move(i),s.energize(s)),memory[s.id]=="Attacking"){s.move(o),h(p(s,210))>s.energy&&s.move(i);var n=A(s);n==null&&(n=_(s)),n==null&&s.energize(s),p(s,400).length==0&&s.energy>a*.5&&(s.move(m(enemy_base.position,s.position,199)),s.energize(enemy_base))}}}function be(){for(s of z("RushOutpostStar")){var e=m(v.position,s.position,199),i=m(v.position,outpost.position,-150),o=m(v.position,outpost.position,150);if(["Attacking","Rushing","Recovering"].includes(memory[s.id])||(memory[s.id]="Rushing"),memory[s.id]=="Rushing"&&y(s.position,v.position)<200&&(memory[s.id]="Recovering"),memory[s.id]=="Recovering"&&(s.energy>a*.5&&(memory[s.id]="Attacking"),s.energy-10>=h(p(s,220))*1.5&&(memory[s.id]="Attacking")),memory[s.id]=="Attacking"&&(s.energy<=a*.2&&(memory[s.id]="Recovering"),s.energy<h(p(s,220))&&!R(s)&&(memory[s.id]="Recovering")),memory[s.id]=="Rushing"&&(s.move(e),graphics.circle(e,2),s.energize(s),h(p(s,210))*2>s.energy&&10+y(s.position,e)/5<s.energy&&s.jump(e),R(s)||s.jump(e)),memory[s.id]=="Recovering"&&(s.move(i),s.energize(s)),memory[s.id]=="Attacking"){s.move(o);var n=A(s);n==null&&(n=_(s)),n==null&&s.energy>20&&outpost.control!="Aecert"&&s.energize(outpost),outpost.energy==0&&s.energize(outpost),n==null&&s.energize(s)}}}function Se(){for(let l=0;l<10;l++)if(["HarvestHome","HarvestOutpost"].includes(k[l])){var e;k[l]=="HarvestOutpost"&&(e=v),k[l]=="HarvestHome"&&(e=S);var i=x(l);for(s of i)["Depositing","Gathering","Chaining","Safe","Spawned"].includes(memory[s.id])||(memory[s.id]="Spawned");if(E[l]==1){let r=i[0];["Defending","Recovering","Depositing","Gathering"].includes(memory[r.id])||(memory[r.id]="Depositing"),memory[r.id]=="Depositing"&&(r.energize(base),d(r,m(base.position,e.position,199)),r.energy<=P&&(memory[r.id]="Gathering")),memory[r.id]=="Gathering"&&(r.energize(r),d(r,m(e.position,base.position,199)),r.energy==r.energy_capacity&&(memory[r.id]="Depositing"))}if(E[l]==2){let r=i[1];["Defending","Recovering"].includes(memory[r.id])||(d(r,m(base.position,e.position,199)),r.energy>=q&&r.energize(base),memory[r.id]="Chaining");let t=i[0];["Defending","Recovering","Depositing","Gathering"].includes(memory[t.id])||(memory[t.id]="Depositing"),memory[t.id]=="Depositing"&&(r.energy<=a*.9&&t.energize(r),d(t,m(r.position,e.position,199)),t.energy<=P&&(memory[t.id]="Gathering")),memory[t.id]=="Gathering"&&(t.energize(t),d(t,m(e.position,r.position,199)),t.energy==t.energy_capacity&&(memory[t.id]="Depositing"))}if(E[l]==3){let r=i[2],t=150;["Defending","Recovering"].includes(memory[r.id])||(d(r,m(base.position,e.position,t)),r.energy>=q&&r.energize(base),memory[r.id]="Chaining");let f=i[1];t+=199,["Defending","Recovering"].includes(memory[f.id])||(d(f,m(base.position,e.position,t)),f.energy>=q&&r.energy<=a*.9&&f.energize(r),memory[f.id]="Chaining");let g=i[0];t+=199,["Defending","Recovering","Depositing","Gathering"].includes(memory[g.id])||(memory[g.id]="Depositing"),memory[g.id]=="Depositing"&&(d(g,m(base.position,e.position,t)),f.energy<=a*.9&&g.energize(f),g.energy<=q&&(memory[g.id]="Gathering")),memory[g.id]=="Gathering"&&(d(g,m(base.position,e.position,t)),(e.energy>150||a<100)&&g.energize(g),g.energy>=a*.9&&(memory[g.id]="Depositing"))}if(E[l]>=4&&a>=30){let r=i[3],t=150;["Defending","Recovering"].includes(memory[r.id])||(d(r,m(base.position,e.position,t)),r.energy>=q&&r.energize(base),memory[r.id]="Chaining"),t+=199;let f=i[2];["Defending","Recovering"].includes(memory[r.id])||(d(f,m(base.position,e.position,t)),f.energy>=q&&r.energy<=a*.9&&f.energize(r),memory[f.id]="Chaining");let g=i[1],u=i[0];t+=199,["Defending","Recovering"].includes(memory[g.id])||(d(g,m(base.position,e.position,t)),tick%2==0?(g.energy>a*.7&&f.energy<=a*.9&&g.energize(f),memory[g.id]="Depositing"):((e.energy>350||a<100)&&g.energize(g),memory[g.id]="Gathering")),["Defending","Recovering"].includes(memory[u.id])||(d(u,m(base.position,e.position,t)),tick%2!=0?(u.energy>a*.7&&f.energy<=a*.9&&u.energize(f),memory[u.id]="Depositing"):((e.energy>700||a<100)&&u.energize(u),memory[u.id]="Gathering"))}if(E[l]>4){let r=4;a==10&&(r=0);for(let t=r;t<E[l];t++){let f=i[t];["Defending","Recovering","Depositing","Gathering"].includes(memory[f.id])||(memory[f.id]="Depositing"),memory[f.id]=="Depositing"&&(f.energize(base),d(f,m(base.position,e.position,199)),f.energy<=P&&(memory[f.id]="Gathering")),memory[f.id]=="Gathering"&&((e.energy>900||a<100)&&f.energize(f),y(f.position,e.position)>200&&d(f,e.position),f.energy==f.energy_capacity&&(memory[f.id]="Depositing"))}}for(s of x(l))C(s)!=null&&(memory[s.id]="Healing");for(s of x(l)){var o=O(s,s.sight.enemies);if(o!=null){if(y(s.position,o.position)<=200&&memory[s.id]!="Healing"&&(memory[s.id]="Defending"),R(s)||(memory[s.id]="Recovering",s.energize(s)),memory[s.id]=="Defending"){var n=A(s);let r=m(n.position,s.position,190);s.move(r)}if(memory[s.id]=="Recovering"){s.energize(s);let r=m(e.position,s.position,190);s.move(r),y(s.position,o.position)<=200&&y(s.position,e.position)>199&&y(s.position,r)/5<s.energy&&s.jump(r),s.energy>=80&&(memory[s.id]="Defending")}}else["Defending","Recovering"].includes(memory[s.id])&&(memory[s.id]="Safe")}}}function ze(){let e=[],i=[],o=[],n=[],l=[],r=[],t=[],f=[],g=[],u=[],c=[e,i,o,n,l,r,t,f,g,u];for(spirit of my_spirits)if(spirit.hp!=0){spirit.mark==null&&spirit.set_mark("Squad9"),memory[spirit.id]==null&&(memory[spirit.id]="Spawned");for(let D=0;D<10;D++)spirit.mark==D&&c[D].push(spirit)}for(let D=0;D<9;D++)for(;c[D].length>ee[D];){let M=c[D].pop();u.push(M),memory[M.id]="Spawned"}for(let D=0;D<9;D++)for(;c[D].length<ee[D]&&u.length>0;){let M=u.pop();c[D].push(M)}for(let D=0;D<10;D++)for(spirit of c[D])spirit.set_mark(String(D))}function T(e,i,o,n){var l,r=y(e,i),t=r/(n-1);return l=m(e,i,t*(o-1)),n>=2?(o==0&&(l=e),o==1&&(l=i)):n>=1&&o==0&&(l=m(e,i,r/2)),l}function B(e){if(!(a<100)&&!R(e)){var i=O(e,e.sight.enemies),o=m(i.position,e.position,220);o!=null&&e.energy<=50&&e.jump(o)}}function y(e,i){let o=e[0],n=e[1],l=i[0],r=i[1],t=l-o,f=r-n;return Math.sqrt(f*f+t*t)}function m(e,i,o){var n=i[0]-e[0],l=i[1]-e[1],r=Math.sqrt(n*n+l*l),t=o/r;let f=e[0]+n*t,g=e[1]+l*t;var u=[f,g];return u}function ie(e){let i=S,o=y(e.position,S.position),n=y(e.position,v.position),l=y(e.position,b.position);return n<o&&(i=v),l<y(e.position,i.position)&&(i=b),i}function ke(){y(base.position,star_zxq.position)<y(base.position,star_a1c.position)?(S=star_zxq,b=star_a1c):(S=star_a1c,b=star_zxq)}function _e(){for(spirit of my_spirits)if(spirit.hp>0){let e=parseInt(spirit.mark,10);E[e]=E[e]+1}}function O(e,i){if(i.length==0)return null;var o=spirits[i[0]],n=9999;for(id of i)y(e.position,spirits[id].position)<n&&(o=spirits[id],n=y(e.position,o.position));return o}function J(e,i){if(i.length==0)return null;var o=spirits[i[0]],n=9999;for(id of i)y(e,spirits[id].position)<n&&(o=spirits[id],n=y(e,o.position));return o}function ne(e){var i=[];for(id of e)i.push(spirits[id]);return i}function h(e){var i=0;for(spirit of e)i+=spirit.energy;return i}function p(e,i=200){var o=ne(e.sight.enemies),n=[];for(enemy of o)y(enemy.position,e.position)<=i&&n.push(enemy);return n}function j(e,i=200){var o=ne(e.sight.friends),n=[];for(ally of o)y(ally.position,e.position)<=i&&n.push(ally);return n}function Ee(){var e=[];for(spirit of my_spirits)spirit.hp>0&&e.push(spirit);return e}function A(e){var i=p(e);if(i.length!=0&&e.energy!=0){var o=[];for(ally of my_spirits)o.push(memory[ally.id+"attack target"]);var n,l,r,t;for(enemy of i){var f=0;for(target of o)target==enemy.id&&(f+=1);(n==null||f<n)&&(n=f,r=enemy),(l==null||f>l)&&(l=f,t=enemy)}if(!(n*a*.2>r.energy))return memory[e.id+"jumped"]=!1,l*a*.2<=t.energy?(memory[e.id+"attack target"]=t.id,e.energize(t),t):(memory[e.id+"attack target"]=r.id,e.energize(r),r)}}function C(e){var i=j(e);if(i.length!=0&&e.energy!=0){var o=[];for(ally of my_spirits)o.push(memory[ally.id+"heal target"]);var n,l;for(ally of i){var r=0;for(target of o)target==ally.id&&(r+=1);(n==null||r<n)&&!(["Gathering","Depositing","Chaining","Healing"].includes(memory[ally.id])&&se(ally)==null)&&ally.energy<a&&memory[ally.id+"heal target"]!=e.id&&(n=r,l=ally)}if(l==null)return null;if(!(n*a*.1>a-l.energy||y(ie(l).position,l.position)<=200&&ie(l).energy>=a*.1))return memory[e.id+"heal target"]=l.id,e.energize(l),l}}function H(e){if(!(a<100)){var i=p(e,400),o=[];for(enemy of i){var u=m(enemy.position,e.position,160),n=y(u,e.position),l=j(enemy,210),r=enemy.energy-enemy.size,t=Ie(enemy);(enemy.energy<=19&&(enemy.energy_capacity>=20||le(e)=="DefendBase")&&e.energy-10>n/5+r+t+1&&y(enemy.position,e.position)>195&&!re(enemy)&&j(enemy,250).length==0||enemy.energy<=19&&(enemy.energy_capacity>=20||le(e)=="DefendBase")&&e.energy-10>n/5+r+t+h(l)*2&&y(enemy.position,e.position)>195&&y(enemy.position,e.position)<360&&!re(enemy))&&o.push(enemy)}var f=[];for(ally of my_spirits)f.push(memory[ally.id+"jump target"]),f.push(memory[ally.id+"attack target"]);var g;for(enemy of o)if(!f.includes(enemy.id)){g=enemy;break}if(g==null)return null;var u=m(g.position,e.position,150);return e.jump(u),e.move(u),e.energize(g),memory[ally.id+"jump target"]=g.id,memory[e.id+"jumped"]=!0,g}}function _(e){var i=j(e),o=[];for(ally of i)(se(ally)!=null||ally.energy<e.energy&&p(ally,300).length>0)&&o.push(ally);if(o.length==0)return null;var n,l;for(ally of o)(n==null||n>ally.energy)&&(n=ally.energy,l=ally);return memory[e.id+"heal target"]=l.id,e.energize(l),l}function je(){for(spirit of my_spirits)memory[spirit.id+"attack target"]="",memory[spirit.id+"heal target"]="",memory[spirit.id+"jump target"]=""}function d(e,i){if(e.move(i),outpost.control=="Aecert"||outpost.energy==0)return;let o=400;if(outpost.energy>400&&(o=600),y(e.position,outpost.position)<=o){e.move(m(outpost.position,e.position,o+5));return}let n=[e.position,i],l=0;if(outpost.control!="Aecert"&&outpost.energy!=0)for(;I(outpost.position,n[0],n[1])<=o+5;){let r=F(n[0],n[1],l),t=F(n[0],n[1],-l);if(I(outpost.position,e.position,r)>o){e.move(r);return}if(I(outpost.position,e.position,t)>o){e.move(t);return}l>200&&e.move(m(outpost.position,e.position,o+5)),l+=.1}}function N(e,i){e.move(i);let o=260,n=O(e,e.sight.enemies);if(n==null)return;if(y(e.position,n.position)<=200){e.move(m(n.position,e.position,o));return}let r=[e.position,i],t=0;for(;I(n.position,r[0],r[1])<=o;){let f=F(r[0],r[1],t),g=F(r[0],r[1],-t);if(I(n.position,e.position,f)>o){e.move(f);return}if(I(n.position,e.position,g)>o){e.move(g);return}if(t>360){e.move(m(n.position,e.position,o+5));return}t+=.1}}function F(e,i,o){let n=i[0],l=i[1];n=n-e[0],l=l-e[1];let r=n*Math.cos(o)-l*Math.sin(o),t=l*Math.cos(o)+n*Math.sin(o);return r=r+e[0],t=t+e[1],[r,t]}function oe(e){return e*e}function K(e,i){return oe(e[0]-i[0])+oe(e[1]-i[1])}function He(e,i,o){var n=K(i,o);if(n===0)return K(e,i);var l=((e[0]-i[0])*(o[0]-i[0])+(e[1]-i[1])*(o[1]-i[1]))/n;return l=Math.max(0,Math.min(1,l)),K(e,[i[0]+l*(o[0]-i[0]),i[1]+l*(o[1]-i[1])])}function I(e,i,o){return Math.sqrt(He(e,i,o))}function z(e){var i=[];for(let o=0;o<10;o++)if(k[o]==e)for(spirit of x(String(o)))i.push(spirit);return i}function we(e){var i=[];for(spirit of my_spirits)memory[spirit.id]==e&&i.push(spirit);return i}function se(e){for(enemy of p(e))if(enemy.last_energized==e.id)return enemy;return null}function qe(e){var i=[];for(ally of j(e))ally.last_energized==e.id&&i.push(ally);return i}function te(e){for(ally of my_spirits)if(memory[ally.id+"heal target"]==e.id)return!0;return!1}function R(e){var i=!0,o=[];for(enemy of p(e,200))enemy.last_energized==e.id&&o.push(enemy);return o.length==0?i=!0:o.length==1?e.energy>o[0].energy?i=!0:i=!1:o.length==2?e.energy>o[0].energy+o[1].energy*2?i=!0:i=!1:i=h(o)*2<e.energy,i}function re(e){if(outpost.sight.enemies.length==0||outpost.energy==0)return!1;var i=!1,o=2;outpost.energy>=500&&(o=8);var n=y(e.position,outpost.position),l=n/20*2/outpost.sight.enemies.length;return l>e.energy?!0:(console.log(e.id+" will die to outpost"),!1)}function Ce(e){var i=0;for(spirit of e)spirit.energy<spirit.size?i+=spirit.energy*2:i+=spirit.size*2;return i}function Ie(e){var i=0;return e.energy<e.size?i+=e.energy*2:i+=e.size*2,i}function x(e){var i=[];for(spirit of my_spirits)spirit.mark==e&&spirit.hp>0&&i.push(spirit);return i}function le(e){for(let i=0;i<10;i++)if(z(k[i]).includes(e))return k[i]}function Ge(e,i,o,n){graphics.style=o;let l=parseFloat(e[0]),r=parseFloat(e[1]),t=[!1,!1,!1,!1,!1,!1,!1];i==0&&(t=[!0,!0,!0,!1,!0,!0,!0]),i==1&&(t=[!1,!1,!0,!1,!1,!0,!1]),i==2&&(t=[!0,!1,!0,!0,!0,!1,!0]),i==3&&(t=[!0,!1,!0,!0,!1,!0,!0]),i==4&&(t=[!1,!0,!0,!0,!1,!0,!1]),i==5&&(t=[!0,!0,!1,!0,!1,!0,!0]),i==6&&(t=[!0,!0,!1,!0,!0,!0,!0]),i==7&&(t=[!0,!1,!0,!1,!1,!0,!1]),i==8&&(t=[!0,!0,!0,!0,!0,!0,!0]),i==9&&(t=[!0,!0,!0,!0,!1,!0,!0]),t[0]&&graphics.line([l-5*n,r-10*n],[l+5*n,r-10*n]),t[1]&&graphics.line([l-5*n,r-10*n],[l-5*n,r]),t[2]&&graphics.line([l+5*n,r-10*n],[l+5*n,r]),t[3]&&graphics.line([l-5*n,r],[l+5*n,r]),t[4]&&graphics.line([l-5*n,r+10*n],[l-5*n,r]),t[5]&&graphics.line([l+5*n,r+10*n],[l+5*n,r]),t[6]&&graphics.line([l-5*n,r+10*n],[l+5*n,r+10*n])}})();
